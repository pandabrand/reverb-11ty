<div id="map"></div>
<script>
  const locations = [
    {% for item in home.locations %}
      {
        'coordinates': [{{ item.latitude }}, {{ item.longitude }}],
        'title': '{{item.title}}',
        'id': '{{ item.locationId }}'
      },
    {% endfor %}
  ];

  let l_icon = L.divIcon({
    html: '<div class="cc-map-marker"><img class="img-fluid" src="{{ "/assets/images/map_icon@2x.png" | url }}" width="34" height="50" /></div>',
    iconSize: [34,50],
    iconAnchor: [18,49],
    popupAnchor: [0, -26]
  });

  //center: [-84.391024, 33.761738], // starting position [lng, lat] Atlanta
  L.mapbox.accessToken = '{{ env.mapbox_token }}';
  let map = L.mapbox.map('map')
      .setView([-0.0005, 51.528308], 15) 
      .addLayer(L.mapbox.styleLayer('mapbox://styles/pandabrand/cke658mxf0q2q19qazrvo1gdy'));

  let markers = L.featureGroup();
  locations.map((location) => {
    console.log(location);
    const marker_place = L.marker(location.coordinates, {icon:l_icon, riseOnHover:true, riseOffset: 3000});
    marker_place.bindPopup('<div class="cc-marker__popup"><div class="font-weight-bold">'+location.title+'</div></div>');
    markers.addLayer(marker_place);
    let query_id = '#'+ location.id;
    //document.querySelector( query_id ).dataset.ccMarker = markers.getLayerId(marker_place);
    marker_place.addEventListener('click', scrollToDetail);
  })
  markers.addTo(map);
  map.fitBounds( markers.getBounds(), [50, 50] );
function scrollToDetail() {
  console.log( this );
  // Waypoint.disableAll();
  // var _id = this._leaflet_id;
  // var scrollItem = jQuery('[data-cc-marker="'+_id+'"]');
  // var container = jQuery('.travel__detail__map__list');
  // jQuery('*').removeClass('img-icon-anim');
  // loadMarker(_id);
  // container.animate({
  //   scrollTop: scrollItem.offset().top - container.offset().top + container.scrollTop(),
  // }, 2000, function() {
  //   Waypoint.enableAll();
  // });
}
</script>